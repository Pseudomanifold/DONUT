{% extends "base.html" %}

{% block content %}

  {% if duration is not none %}
  <div class="query-statistics">
    (execution time: {{ duration }}s)
  </div>
  {% endif %}

  {% if data is not none %}
  <ol class="search-results">
    {% for d in data %}
    <li class="search-result">
      <article>
        {% set document = d["document"] %}

        <h1>
          {{ document.title }}
          {% if document.year | length %}
            ({{ document.year }})
          {% endif %}
        </h1>
        <address>
          {{ document.author | join(', ') }}
        </address>

        {% if document.abstract | length %}
        <details>
          <summary>Abstract</summary>

          {{ document.abstract }}
        </details>
        {% endif %}

        <ul class="references">
          {% if document.url | length %}
            <li>
              <a href="{{ document.url }}">URL</a>
            </li>
          {% endif %}

          {% if document.doi | length %}
            <li>
              {% set url = "https://dx.doi.org/" ~ document.doi %}
              <a href="{{ url }}">DOI</a>
            </li>
          {% endif %}

        </ul>

        {% if document.keywords is defined %}
        <div class="tags">
          <ul>
            {% for keyword in document.keywords %}
            <li>
              {% set url = url_for("index", q='tag:"' ~ keyword ~ '"') %}
              <a href={{ url}}>{{ keyword }}</a>
            </li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
        <a href="{{ url_for('view', identifier=d['id']) }}">(View)</a>
      </article>
    </li>
    {% endfor %}
  </ol>
  {% endif %}

{% endblock %}
